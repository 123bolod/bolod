<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‚Äî Daud Store</title>
  <meta name="description" content="‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ - single-file responsive e-commerce (admin upload, feedback with product image, pagination).">
  <style>
    :root{ --bg:#f8fafc; --card:#fff; --muted:#6b7280; --accent:#ff7a00; --accent-2:#ff9a33; --shadow:0 10px 30px rgba(2,6,23,0.06); --radius:14px;}
    *{box-sizing:border-box} html,body{height:100%} body{margin:0;font-family:Inter,system-ui,Arial;color:#0f172a;background:var(--bg);-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}
    .topbar{position:sticky;top:0;z-index:120;display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;box-shadow:0 6px 20px rgba(0,0,0,0.08)}
    .brand-left{display:flex;align-items:center;gap:12px} #siteLogo{width:52px;height:52px;border-radius:12px;background:#fff;padding:6px;object-fit:contain;box-shadow:var(--shadow)}
    .brand-title{font-weight:800;font-size:1.05rem} .brand-sub{font-size:12px;opacity:.95}
    .nav{display:flex;gap:12px;align-items:center}
    .nav a{font-weight:700;color:rgba(255,255,255,0.95);padding:8px 10px;border-radius:10px;transition:transform .18s}
    .nav a:hover{background:rgba(255,255,255,0.08);transform:translateY(-2px)}
    .top-actions{display:flex;gap:8px;align-items:center}
    .btn{padding:10px 14px;border-radius:14px;border:none;cursor:pointer;font-weight:800;box-shadow:0 12px 28px rgba(2,6,23,0.06);transition:transform .18s,box-shadow .18s;background:#fff;color:var(--accent)}
    .btn.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.18)} .btn.primary{background:var(--accent);color:#fff} .btn.small{padding:8px 10px;font-size:.9rem}
    .btn:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 20px 40px rgba(0,0,0,0.12)}
    main{padding:16px;max-width:1200px;margin:0 auto}
    .hero{display:flex;flex-direction:column;gap:12px} .hero-top{display:flex;align-items:center;gap:12px;justify-content:space-between}
    .rotating-text{font-size:1.1rem;font-weight:800;color:var(--accent);min-height:48px;display:flex;align-items:center;justify-content:center}
    .top-three{display:flex;gap:10px;justify-content:center;flex-wrap:nowrap;overflow:hidden}
    .small-card{flex:0 0 28%;min-width:90px;height:110px;background:var(--card);border-radius:14px;display:flex;align-items:center;justify-content:center;padding:8px;box-shadow:var(--shadow);cursor:pointer;transition:transform .18s}
    .small-card:hover{transform:translateY(-4px)} .small-card img{max-width:100%;max-height:100%;object-fit:contain}
    .slider{width:100%;height:220px;background:var(--card);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;align-items:center;justify-content:center}
    .slides{display:flex;height:100%;transition:transform .6s ease}
    .slide{min-width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:12px}
    .slide img{max-height:180px;max-width:90%;object-fit:contain;border-radius:10px}
    .dots{display:flex;gap:8px;justify-content:center;margin-top:8px}
    .dot{width:10px;height:10px;border-radius:50%;background:rgba(0,0,0,0.12);cursor:pointer} .dot.active{background:var(--accent)}
    .section{margin-top:18px} .section h2{margin:0 0 6px 0}
    .products-grid{display:grid;gap:14px;grid-template-columns:repeat(3,1fr)}
    .product-card{background:var(--card);border-radius:14px;padding:12px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:8px;align-items:center}
    .product-card img{width:100%;height:160px;object-fit:contain;border-radius:10px}
    .product-meta{width:100%;text-align:center} .product-meta h4{margin:6px 0 4px 0;font-size:1rem} .product-meta p{margin:0;color:var(--muted);font-size:.95rem}
    .card-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:8px}
    .pill{padding:10px 12px;border-radius:999px;border:none;background:#fff;color:var(--accent);box-shadow:0 8px 18px rgba(0,0,0,0.06);font-weight:800;transition:transform .18s, box-shadow .18s}
    .pill:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 16px 32px rgba(0,0,0,0.12)}
    .pill:active{transform:translateY(0) scale(1);box-shadow:0 8px 18px rgba(0,0,0,0.06)}
    .pagination{display:flex;gap:8px;justify-content:center;margin-top:12px}
    .page-btn{padding:8px 12px;border-radius:10px;border:1px solid #eee;background:var(--card);cursor:pointer} .page-btn.active{background:var(--accent);color:#fff;border:none}
    .center-card{background:var(--card);padding:16px;border-radius:14px;box-shadow:var(--shadow);margin:16px 0}
    .cart-item{display:flex;gap:12px;align-items:center;justify-content:space-between;border-radius:12px;padding:10px;background:#fff}
    .cart-item img{height:72px;width:72px;object-fit:contain;border-radius:8px}
    .feedback-list{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    .fb-item{background:#fff;padding:10px;border-radius:10px;box-shadow:var(--shadow)}
    .admin-panel{position:fixed;right:-520px;top:72px;width:520px;background:var(--card);border-radius:14px;padding:14px;box-shadow:0 30px 60px rgba(2,6,23,0.2);transition:right .35s;z-index:220;max-height:82vh;overflow:auto}
    .admin-panel.active{right:16px}
    .admin-row{display:flex;flex-direction:column;gap:8px;margin-top:10px}
    .admin-row input, .admin-row textarea, .admin-row select{padding:10px;border-radius:10px;border:1px solid #eee}
    .modal{display:none;position:fixed;inset:0;background:rgba(2,6,23,0.45);align-items:center;justify-content:center;z-index:300;padding:18px}
    .modal.show{display:flex}
    .modal-card{background:var(--card);padding:16px;border-radius:14px;box-shadow:var(--shadow);max-width:720px;width:100%;position:relative}
    .modal-close{position:absolute;right:8px;top:8px;border:none;background:transparent;font-size:18px;cursor:pointer}
    @media (max-width:1000px){ .products-grid{grid-template-columns:repeat(2,1,1fr)} .small-card{flex:0 0 32%} }
    @media (max-width:640px){
      .nav{display:none} .top-three{gap:8px;overflow:auto;padding:6px} .small-card{flex:0 0 30%}
      .slider{height:180px} .product-card img{width:100%;height:auto;max-height:140px}
      .products-grid{grid-template-columns:repeat(1,1fr)} .hero-top{flex-direction:column;align-items:center;gap:8px}
      main{padding:12px} .admin-panel{width:94%} .topbar{flex-wrap:wrap;gap:8px} .top-actions{flex-wrap:wrap;width:100%;justify-content:center}
      .top-actions .btn{flex:1 1 calc(50% - 12px);margin-top:6px}
    }
    .muted{color:var(--muted)} .hidden{display:none} .page{display:none} .page.active{display:block} .admin-only{display:none}
    .toast{background:var(--accent);color:#fff;padding:8px 12px;border-radius:10px;position:fixed;top:80px;right:16px;z-index:999;box-shadow:0 10px 30px rgba(0,0,0,0.12);display:none}
    .toast.show{display:block}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand-left">
      <img id="siteLogo" src="" alt="‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ Logo">
      <div><div class="brand-title">‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞</div><div class="brand-sub">Quality ‚Ä¢ Trust ‚Ä¢ Fast</div></div>
    </div>
    <nav class="nav" aria-label="Main">
      <a href="#home" class="nav-link">Home</a>
      <a href="#products" class="nav-link">Products</a>
      <a href="#cart" class="nav-link">Cart</a>
      <a href="#contact" class="nav-link">Contact</a>
      <a href="#feedback" class="nav-link">Feedback</a>
    </nav>
    <div class="top-actions">
      <button id="userAuthBtn" class="btn small">Sign Up / Login</button>
      <button id="adminOpenBtn" class="btn primary small">Admin</button>
      <button id="shareBtn" class="btn small admin-only">Share</button>
    </div>
  </header>

  <div id="toast" class="toast"></div>

  <main>
    <section id="home" class="page active">
      <div class="hero">
        <div class="hero-top">
          <div class="logo-box"><img id="heroLogo" src="" alt="logo" style="width:64px;height:64px;border-radius:10px;object-fit:contain"></div>
          <div class="hero-center"><div id="rotatingText" class="rotating-text">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ ‚Äî ‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞</div></div>
          <div style="width:64px"></div>
        </div>
        <div class="top-three" id="topThree"></div>
        <div class="slider" id="sliderWrap"><div class="slides" id="slides"></div></div>
        <div class="dots" id="slideDots"></div>
      </div>
      <section class="section">
        <div style="display:flex;justify-content:space-between;align-items:center"><h2>Trending Products</h2><div id="productsCount" class="muted"></div></div>
        <div id="productsGrid" class="products-grid"></div>
        <div id="pagination" class="pagination"></div>
      </section>
    </section>

    <section id="product-view" class="page"><div class="center-card" id="productViewCard"></div></section>

    <section id="products" class="page">
      <div class="center-card">
        <h2>All Products</h2>
        <input id="productSearchInput" placeholder="‡¶™‡¶£‡ßç‡¶Ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®..." style="width:100%;padding:10px;border-radius:10px;border:1px solid #eee;margin-top:6px;margin-bottom:8px" />
        <div id="productsGridFull" class="products-grid"></div>
        <div id="paginationFull" class="pagination"></div>
      </div>
    </section>

    <section id="cart" class="page">
      <div class="center-card">
        <h2>Your Cart</h2>
        <div id="cartItems" class="card-list"></div>
        <div style="text-align:center;margin-top:12px"><button id="checkoutBtn" class="btn primary">Checkout (Demo)</button></div>
      </div>
    </section>

    <section id="contact" class="page">
      <div class="center-card">
        <h2>Contact</h2>
        <p class="muted">Contact via WhatsApp or Messenger (set by admin).</p>
        <div style="display:flex;gap:10px;justify-content:center;margin-top:12px">
          <button id="contactWhatsapp" class="btn" style="background:#25D366;color:#fff">WhatsApp</button>
          <button id="contactMessenger" class="btn" style="background:#0084FF;color:#fff">Messenger</button>
        </div>
      </div>
    </section>

    <section id="feedback" class="page">
      <div class="center-card">
        <h2>Feedback</h2>
        <div style="margin-top:10px">
          <h3>Website feedback</h3>
          <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
            <button id="siteGoodBtn" class="btn">üëç Good (<span id="goodCount">0</span>)</button>
            <button id="siteBadBtn" class="btn">üëé Bad (<span id="badCount">0</span>)</button>
          </div>
        </div>
        <div style="margin-top:14px">
          <h3>Product feedback</h3>
          <label>Search product</label>
          <input id="feedbackSearch" placeholder="Type product name..." style="width:100%;padding:10px;border-radius:10px;border:1px solid #eee;margin-top:6px" />
          <div id="feedbackSearchResults" style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px"></div>
          <div id="selectedFeedbackProduct" style="display:none;margin-top:12px">
            <div style="display:flex;gap:10px;align-items:center">
              <img id="feedbackSelectedImg" src="" alt="" style="height:92px;border-radius:10px;box-shadow:var(--shadow)">
              <div><strong id="feedbackSelectedName"></strong><br><span id="feedbackSelectedPrice" class="muted"></span></div>
            </div>
            <textarea id="feedbackText" placeholder="Write your feedback..." rows="4" style="width:100%;margin-top:10px;padding:10px;border-radius:10px;border:1px solid #eee"></textarea>
            <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
              <button id="submitFeedbackBtn" class="btn primary">Submit Feedback</button>
              <button id="viewFeedbacksBtn" class="btn">View All</button>
            </div>
          </div>
          <div id="feedbackList" class="feedback-list" style="margin-top:12px"></div>
        </div>
      </div>
    </section>
  </main>

  <aside id="adminPanel" class="admin-panel" aria-hidden="true">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
      <h3>Admin Panel</h3>
      <div><button id="closeAdmin" class="btn small">‚úï</button></div>
    </div>

    <div class="admin-row">
      <label><strong>Admin (Unlock)</strong></label>
      <input id="adminEmail" type="email" placeholder="admin email (same as user login)" />
      <input id="adminPass" type="password" placeholder="admin password" />
      <div style="display:flex;gap:8px">
        <button id="adminLoginBtn" class="btn primary">Unlock Admin</button>
        <button id="adminLogoutBtn" class="btn">Lock</button>
      </div>
      <small class="muted">Tip: First log in from <em>Sign Up / Login</em> using the admin email, then unlock with the admin password.</small>
    </div>

    <hr/>

    <div class="admin-row admin-only">
      <label><strong>Admin Settings</strong></label>
      <input id="adminEmailSetting" type="email" placeholder="New admin email" />
      <input id="adminPassSetting" type="password" placeholder="New admin password" />
      <button id="saveAdminConfigBtn" class="btn">Save Admin Settings</button>
      <small class="muted">Only the unlocked admin can change these. If you change the admin email, you must re-login as that email.</small>
    </div>

    <div class="admin-row admin-only">
      <label><strong>Upload Logo</strong></label>
      <input id="logoInput" type="file" accept="image/*" />
      <button id="logoSetBtn" class="btn">Upload Logo</button>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>Upload Product</strong></label>
      <input id="productImageInput" type="file" accept="image/*" />
      <input id="productName" type="text" placeholder="Product name" />
      <input id="productPrice" type="text" placeholder="Price" />
      <input id="productDesc" type="text" placeholder="Short description" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="addProductBtn" class="btn primary">Add Product</button>
        <button id="clearProductsBtn" class="btn">Clear All</button>
      </div>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>Animated sentences (comma separated)</strong></label>
      <textarea id="sentencesInput" placeholder="Welcome!, Best deals!, Fast delivery" rows="3"></textarea>
      <button id="saveSentencesBtn" class="btn primary">Save Sentences</button>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>Currency Symbol (shown on product cards)</strong></label>
      <input id="currencyInput" type="text" placeholder="‡ß≥ or $" />
      <button id="setCurrencyBtn" class="btn">Set Currency</button>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>WhatsApp (country + number)</strong></label>
      <div style="display:flex;gap:8px">
        <select id="whatsappCountry"><option value="+880" selected>+880 (BD)</option><option value="+91">+91 (IN)</option><option value="+1">+1 (US)</option><option value="+44">+44 (UK)</option><option value="+971">+971 (UAE)</option></select>
        <input id="whatsappNumber" placeholder="1XXXXXXXXX" />
      </div>
      <label style="margin-top:8px"><strong>Messenger link</strong></label>
      <input id="messengerInput" placeholder="https://m.me/username" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="saveContactsBtn" class="btn primary">Save Contacts</button>
        <button id="openContactsBtn" class="btn">Test Contact</button>
      </div>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>Share (Admin)</strong></label>
      <button id="openShare" class="btn">Open Share Modal</button>
    </div>

    <div class="admin-row admin-only" style="margin-top:10px">
      <label><strong>Public Link (GitHub Pages)</strong></label>
      <input id="publicLinkInput" type="text" placeholder="https://username.github.io/your-site" />
      <button id="savePublicLinkBtn" class="btn">Save Public Link</button>
    </div>
  </aside>

  <div id="shareModal" class="modal">
    <div class="modal-card">
      <button class="modal-close" data-close>‚úï</button>
      <h3>Share ‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞</h3>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="shareWhatsapp" class="btn" style="background:#25D366;color:#fff">WhatsApp</button>
        <button id="shareMessenger" class="btn" style="background:#0084FF;color:#fff">Messenger</button>
        <button id="copyLinkBtn" class="btn">Copy Link</button>
      </div>
      <p class="muted" style="margin-top:8px">Host on GitHub Pages/Netlify for sharing to work.</p>
    </div>
  </div>

  <div id="userModal" class="modal">
    <div class="modal-card">
      <button class="modal-close" data-close>‚úï</button>
      <h3>Sign Up / Login</h3>
      <input id="userEmail" type="email" placeholder="Email" />
      <input id="userPass" type="password" placeholder="Password" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="userSignupBtn" class="btn primary">Sign Up</button>
        <button id="userLoginBtn" class="btn">Login</button>
      </div>
    </div>
  </div>

  <div id="viewFeedbackModal" class="modal">
    <div class="modal-card">
      <button class="modal-close" data-close>‚úï</button>
      <h3>All Feedbacks</h3>
      <div id="allFeedbacks"></div>
    </div>
  </div>

  <script>
  const LS_KEYS = { SITE:'daudSite', PRODUCTS:'daudProducts', CART:'daudCart', FEEDBACKS:'daudFeedbacks', SITE_FEEDBACK:'daudSiteFeedback', ADMIN:'daudAdmin', LIKES:'daudLikes', LIKE_COUNTS:'daudLikeCounts', DISLIKE_COUNTS:'daudDislikeCounts', USERS:'daudUsers', CURRENT_USER:'daudCurrentUser', ADMIN_LOGGED_IN:'daudAdminLoggedIn' };
  const ADMIN_CONFIG_KEY='daudAdminConfig';

  const pages=document.querySelectorAll('.page'); const navLinks=document.querySelectorAll('.nav-link');
  const siteLogo=document.getElementById('siteLogo'); const heroLogo=document.getElementById('heroLogo'); const rotatingText=document.getElementById('rotatingText');
  const topThree=document.getElementById('topThree'); const slides=document.getElementById('slides'); const slideDots=document.getElementById('slideDots');
  const productsGrid=document.getElementById('productsGrid'); const productsGridFull=document.getElementById('productsGridFull'); const pagination=document.getElementById('pagination'); const paginationFull=document.getElementById('paginationFull'); const productsCount=document.getElementById('productsCount');
  const productViewCard=document.getElementById('productViewCard'); const cartItems=document.getElementById('cartItems');
  const feedbackSearch=document.getElementById('feedbackSearch'); const feedbackSearchResults=document.getElementById('feedbackSearchResults'); const selectedFeedbackProduct=document.getElementById('selectedFeedbackProduct'); const feedbackSelectedImg=document.getElementById('feedbackSelectedImg'); const feedbackSelectedName=document.getElementById('feedbackSelectedName'); const feedbackSelectedPrice=document.getElementById('feedbackSelectedPrice'); const feedbackText=document.getElementById('feedbackText'); const submitFeedbackBtn=document.getElementById('submitFeedbackBtn'); const viewFeedbacksBtn=document.getElementById('viewFeedbacksBtn'); const allFeedbacks=document.getElementById('allFeedbacks'); const goodCount=document.getElementById('goodCount'); const badCount=document.getElementById('badCount');
  const publicLinkInput=document.getElementById('publicLinkInput'); const savePublicLinkBtn=document.getElementById('savePublicLinkBtn');
  const productSearchInput=document.getElementById('productSearchInput'); let filteredProducts=[]; let adminLoggedIn=false; const feedbackList=document.getElementById('feedbackList');
  const userAuthBtn=document.getElementById('userAuthBtn'); const adminOpenBtn=document.getElementById('adminOpenBtn'); const shareBtn=document.getElementById('shareBtn'); const adminPanel=document.getElementById('adminPanel'); const closeAdmin=document.getElementById('closeAdmin'); const adminEmail=document.getElementById('adminEmail'); const adminPass=document.getElementById('adminPass'); const adminLoginBtn=document.getElementById('adminLoginBtn'); const adminLogoutBtn=document.getElementById('adminLogoutBtn');
  const adminEmailSetting=document.getElementById('adminEmailSetting'); const adminPassSetting=document.getElementById('adminPassSetting'); const saveAdminConfigBtn=document.getElementById('saveAdminConfigBtn');
  const logoInput=document.getElementById('logoInput'); const logoSetBtn=document.getElementById('logoSetBtn'); const productImageInput=document.getElementById('productImageInput'); const productName=document.getElementById('productName'); const productPrice=document.getElementById('productPrice'); const productDesc=document.getElementById('productDesc'); const addProductBtn=document.getElementById('addProductBtn'); const clearProductsBtn=document.getElementById('clearProductsBtn');
  const viewFeedbacksModal=document.getElementById('viewFeedbackModal'); const userModal=document.getElementById('userModal'); const shareModal=document.getElementById('shareModal'); const sentencesInput=document.getElementById('sentencesInput'); const saveSentencesBtn=document.getElementById('saveSentencesBtn'); const currencyInput=document.getElementById('currencyInput'); const setCurrencyBtn=document.getElementById('setCurrencyBtn'); const whatsappCountry=document.getElementById('whatsappCountry'); const whatsappNumber=document.getElementById('whatsappNumber'); const messengerInput=document.getElementById('messengerInput'); const saveContactsBtn=document.getElementById('saveContactsBtn'); const openContactsBtn=document.getElementById('openContactsBtn'); const openShare=document.getElementById('openShare'); const toast=document.getElementById('toast');

  const DEFAULT_PRODUCTS=[{id:1,name:'Sample Product',price:'100',desc:'This is a sample product for demonstration.',image:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAA5klEQVR4nO3QQQkAIADAQLV/Z63gXiLcJRibe3BrvQ74iVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWYFZgVmBWcEBil4Bx/GEGnoAAAAASUVORK5CYII='}];

  let products=[]; const ITEMS_PER_PAGE=6; let currentPageHome=1; let currentPageFull=1; let likes=[]; let likeCounts={}; let dislikeCounts={}; let cart=[];
  let rotatingSentences=['‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ ‚Äî ‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞','Best deals!','Fast delivery']; let currencySymbol='‡ß≥'; let whatsappLink=''; let messengerLink=''; let publicLink='';
  let users=[]; let currentUser=null;
  let adminConfig={email:'mdipml000@gmail.com', pass:'admin123'};

  function showToast(msg){ const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2200); }
  function switchPage(t){ document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); const el=document.getElementById(t); if(el) el.classList.add('active'); }

  if(document.readyState!=='loading') initApp(); else document.addEventListener('DOMContentLoaded', initApp);

  function initApp(){
    setupNavigation();
    loadAdminConfig();
    loadSiteSettings();
    loadProducts();
    loadCart();
    loadLikes();
    loadLikeCounts();
    setupFeedbackSystem();
    autoRotateText();
    initAdminPanel();
    initUserSystem();
    checkAdminPersistentLogin();

    if(productSearchInput){ productSearchInput.addEventListener('input', handleProductSearch);}
    document.getElementById('shareBtn').addEventListener('click',(e)=>{e.preventDefault(); document.getElementById('shareModal').classList.add('show');});
  }

  function setupNavigation(){ document.querySelectorAll('.nav-link').forEach(link=>{ link.addEventListener('click',e=>{e.preventDefault(); const id=(link.getAttribute('href')||'').replace('#','')||'home'; switchPage(id);}); }); switchPage('home'); }

  function loadAdminConfig(){ try{ const c=JSON.parse(localStorage.getItem(ADMIN_CONFIG_KEY)||'null'); if(c && c.email){ adminConfig=c; } }catch(e){} }
  function saveAdminConfig(){ localStorage.setItem(ADMIN_CONFIG_KEY, JSON.stringify(adminConfig)); }

  function loadSiteSettings(){
    const saved=JSON.parse(localStorage.getItem('daudSite')||'{}');
    if(saved.logo){document.getElementById('siteLogo').src=document.getElementById('heroLogo').src=saved.logo;}
    if(saved.sentences){rotatingSentences=saved.sentences.split(',').map(s=>s.trim()).filter(Boolean);}
    if(saved.currency){currencySymbol=saved.currency;}
    if(saved.whatsapp){whatsappLink=saved.whatsapp;}
    if(saved.messenger){messengerLink=saved.messenger;}
    if(saved.publicLink){publicLink=saved.publicLink; const inp=document.getElementById('publicLinkInput'); if(inp) inp.value=publicLink;}
  }

  function loadProducts(){
    products=DEFAULT_PRODUCTS.slice(); updateProductsUI();
    try{ const local=JSON.parse(localStorage.getItem('daudProducts')||'[]'); if(Array.isArray(local)&&local.length){ products=local; updateProductsUI(); } }catch(e){}
    fetch('products.json?'+Date.now()).then(r=>r.ok?r.json():null).then(remote=>{
      if(!remote) return;
      if(Array.isArray(remote)) products=remote;
      else {
        if(Array.isArray(remote.products)) products=remote.products;
        if(remote.site){
          const saved=JSON.parse(localStorage.getItem('daudSite')||'{}');
          if(remote.site.logo){ document.getElementById('siteLogo').src=document.getElementById('heroLogo').src=remote.site.logo; saved.logo=remote.site.logo; }
          if(remote.site.currency){ currencySymbol=remote.site.currency; saved.currency=remote.site.currency; }
          if(remote.site.sentences){ saved.sentences=remote.site.sentences; rotatingSentences=remote.site.sentences.split(',').map(s=>s.trim()).filter(Boolean); }
          if(remote.site.whatsapp){ whatsappLink=remote.site.whatsapp; saved.whatsapp=remote.site.whatsapp; }
          if(remote.site.messenger){ messengerLink=remote.site.messenger; saved.messenger=remote.site.messenger; }
          if(remote.site.publicLink){ publicLink=remote.site.publicLink; saved.publicLink=remote.site.publicLink; const inp=document.getElementById('publicLinkInput'); if(inp) inp.value=publicLink; }
          localStorage.setItem('daudSite', JSON.stringify(saved));
        }
      }
      updateProductsUI();
    }).catch(()=>{});
  }

  function updateProductsUI(){ document.getElementById('productsCount').textContent=products.length?products.length+' items':'No products yet'; filteredProducts=[]; renderProducts(1); renderProductsFull(1); renderTopThree(); initSlider(); }

  function renderProducts(page){
    currentPageHome=page; document.getElementById('productsGrid').innerHTML=''; document.getElementById('pagination').innerHTML='';
    const arr=products; const start=(page-1)*3; const paginated=arr.slice(start,start+3);
    if(!arr.length){ const m=document.createElement('div'); m.className='muted'; m.style.textAlign='center'; m.style.padding='12px'; m.textContent='No products available. Please log in as admin to add products.'; document.getElementById('productsGrid').appendChild(m); return; }
    paginated.forEach(p=>document.getElementById('productsGrid').appendChild(createProductCard(p,false)));
    const pagesCount=Math.ceil(arr.length/3);
    if(pagesCount>1){ const prev=document.createElement('button'); prev.textContent='Prev'; prev.className='page-btn'; if(page===1) prev.disabled=true; prev.addEventListener('click',()=>page>1&&renderProducts(page-1)); document.getElementById('pagination').appendChild(prev); }
    for(let i=1;i<=pagesCount;i++){ const b=document.createElement('button'); b.textContent=i; b.className='page-btn'+(i===page?' active':''); b.addEventListener('click',()=>renderProducts(i)); document.getElementById('pagination').appendChild(b); }
    if(pagesCount>1){ const next=document.createElement('button'); next.textContent='Next'; next.className='page-btn'; if(page===pagesCount) next.disabled=true; next.addEventListener('click',()=>page<pagesCount&&renderProducts(page+1)); document.getElementById('pagination').appendChild(next); }
  }

  function renderProductsFull(page){
    currentPageFull=page; document.getElementById('productsGridFull').innerHTML=''; document.getElementById('paginationFull').innerHTML='';
    const arr=(filteredProducts&&filteredProducts.length)?filteredProducts:products; const start=(page-1)*6; const paginated=arr.slice(start,start+6);
    if(!arr.length){ const m=document.createElement('div'); m.className='muted'; m.style.textAlign='center'; m.style.padding='12px'; m.textContent='No products available. Please log in as admin to add products.'; document.getElementById('productsGridFull').appendChild(m); return; }
    paginated.forEach(p=>document.getElementById('productsGridFull').appendChild(createProductCard(p,true)));
    const pagesCount=Math.ceil(arr.length/6);
    if(pagesCount>1){ const prev=document.createElement('button'); prev.textContent='Prev'; prev.className='page-btn'; if(page===1) prev.disabled=true; prev.addEventListener('click',()=>page>1&&renderProductsFull(page-1)); document.getElementById('paginationFull').appendChild(prev); }
    for(let i=1;i<=pagesCount;i++){ const b=document.createElement('button'); b.textContent=i; b.className='page-btn'+(i===page?' active':''); b.addEventListener('click',()=>renderProductsFull(i)); document.getElementById('paginationFull').appendChild(b); }
    if(pagesCount>1){ const next=document.createElement('button'); next.textContent='Next'; next.className='page-btn'; if(page===pagesCount) next.disabled=true; next.addEventListener('click',()=>page<pagesCount&&renderProductsFull(page+1)); document.getElementById('paginationFull').appendChild(next); }
  }

  function createProductCard(item,withView){
    const d=document.createElement('div'); d.className='product-card';
    const img=document.createElement('img'); img.src=item.image; img.alt=item.name; d.appendChild(img);
    const meta=document.createElement('div'); meta.className='product-meta'; meta.innerHTML='<h4>'+item.name+'</h4><p>'+currencySymbol+item.price+'</p>'; d.appendChild(meta);
    const actions=document.createElement('div'); actions.className='card-actions';
    const cartBtn=document.createElement('button'); cartBtn.className='pill'; cartBtn.textContent='Add to Cart'; cartBtn.addEventListener('click',()=>addToCart(item)); actions.appendChild(cartBtn);
    const likeBtn=document.createElement('button'); likeBtn.className='pill'; const liked=likes.includes(item.id); const lc=likeCounts[item.id]||0; const dc=dislikeCounts[item.id]||0; likeBtn.textContent=(liked?'Dislike':'Like')+' ('+lc+'/'+dc+')'; likeBtn.addEventListener('click',()=>toggleLike(item.id)); actions.appendChild(likeBtn);
    if(withView){ const viewBtn=document.createElement('button'); viewBtn.className='pill'; viewBtn.textContent='View'; viewBtn.addEventListener('click',()=>viewProduct(item)); actions.appendChild(viewBtn); }
    if(adminLoggedIn){ const e=document.createElement('button'); e.className='pill'; e.textContent='Edit'; e.addEventListener('click',()=>editProduct(item.id)); actions.appendChild(e); const del=document.createElement('button'); del.className='pill'; del.textContent='Delete'; del.addEventListener('click',()=>deleteProduct(item.id)); actions.appendChild(del); }
    d.appendChild(actions); return d;
  }

  function handleProductSearch(){ const q=document.getElementById('productSearchInput').value.trim().toLowerCase(); filteredProducts = q ? products.filter(p=>p.name.toLowerCase().includes(q)) : []; renderProductsFull(1); }

  function loadCart(){ cart=JSON.parse(localStorage.getItem('daudCart')||'[]'); renderCart(); } function saveCart(){ localStorage.setItem('daudCart', JSON.stringify(cart)); }
  function addToCart(item){ const ex=cart.find(i=>i.id===item.id); if(ex) ex.qty+=1; else cart.push(Object.assign({},item,{qty:1})); saveCart(); renderCart(); alert('Product added to cart'); }
  function removeFromCart(id){ cart=cart.filter(i=>i.id!==id); saveCart(); renderCart(); }
  function renderCart(){ const el=document.getElementById('cartItems'); el.innerHTML=''; if(!cart.length){ el.innerHTML='<p class="muted">Cart is empty</p>'; return;} cart.forEach(item=>{ const w=document.createElement('div'); w.className='cart-item'; w.innerHTML='<div style="display:flex;gap:10px;align-items:center"><img src="'+item.image+'" alt="'+item.name+'"><div><strong>'+item.name+'</strong><br><span>'+currencySymbol+item.price+' x '+item.qty+'</span></div></div><button class="pill" style="background:var(--accent);color:#fff" onclick="removeFromCart('+item.id+')">Remove</button>'; el.appendChild(w); }); }

  function viewProduct(item){ const c=document.getElementById('productViewCard'); c.innerHTML=''; const img=document.createElement('img'); img.src=item.image; img.alt=item.name; Object.assign(img.style,{width:'100%',height:'220px',objectFit:'contain'}); c.appendChild(img); const h3=document.createElement('h3'); h3.textContent=item.name; c.appendChild(h3); const p=document.createElement('p'); p.textContent=item.desc; c.appendChild(p); const price=document.createElement('strong'); price.textContent=currencySymbol+item.price; c.appendChild(price); const add=document.createElement('button'); add.className='btn primary'; add.textContent='Add to Cart'; add.style.marginTop='12px'; add.addEventListener('click',()=>addToCart(item)); c.appendChild(add); switchPage('product-view'); }

  function loadLikes(){ likes=JSON.parse(localStorage.getItem('daudLikes')||'[]'); } function saveLikes(){ localStorage.setItem('daudLikes', JSON.stringify(likes)); }
  function loadLikeCounts(){ likeCounts=JSON.parse(localStorage.getItem('daudLikeCounts')||'{}'); dislikeCounts=JSON.parse(localStorage.getItem('daudDislikeCounts')||'{}'); }
  function saveLikeCounts(){ localStorage.setItem('daudLikeCounts', JSON.stringify(likeCounts)); localStorage.setItem('daudDislikeCounts', JSON.stringify(dislikeCounts)); }
  function toggleLike(id){ const idx=likes.indexOf(id); if(idx===-1){ likes.push(id); likeCounts[id]=(likeCounts[id]||0)+1; } else { likes.splice(idx,1); dislikeCounts[id]=(dislikeCounts[id]||0)+1; } saveLikes(); saveLikeCounts(); renderProducts(currentPageHome); renderProductsFull(currentPageFull); }

  let allFeedback=[]; let selectedProduct=null;
  function setupFeedbackSystem(){ loadFeedbacks(); document.getElementById('feedbackSearch').addEventListener('input', handleFeedbackSearch); document.getElementById('submitFeedbackBtn').addEventListener('click', submitFeedback); document.getElementById('viewFeedbacksBtn').addEventListener('click', openAllFeedbacksModal); document.getElementById('siteGoodBtn').addEventListener('click',()=>updateSiteFeedback('good')); document.getElementById('siteBadBtn').addEventListener('click',()=>updateSiteFeedback('bad')); }
  function handleFeedbackSearch(){ const q=document.getElementById('feedbackSearch').value.trim().toLowerCase(); const wrap=document.getElementById('feedbackSearchResults'); wrap.innerHTML=''; if(!q) return; products.filter(p=>p.name.toLowerCase().includes(q)).forEach(item=>{ const b=document.createElement('button'); b.className='pill'; b.textContent=item.name; b.addEventListener('click',()=>selectFeedbackProduct(item)); wrap.appendChild(b); }); }
  function selectFeedbackProduct(item){ selectedProduct=item; document.getElementById('feedbackSelectedImg').src=item.image; document.getElementById('feedbackSelectedName').textContent=item.name; document.getElementById('feedbackSelectedPrice').textContent=currencySymbol+item.price; document.getElementById('selectedFeedbackProduct').style.display='block'; document.getElementById('feedbackSearchResults').innerHTML=''; document.getElementById('feedbackSearch').value=''; }
  function loadFeedbacks(){ allFeedback=JSON.parse(localStorage.getItem('daudFeedbacks')||'[]'); const siteFb=JSON.parse(localStorage.getItem('daudSiteFeedback')||'{"good":0,"bad":0}'); document.getElementById('goodCount').textContent=siteFb.good; document.getElementById('badCount').textContent=siteFb.bad; }
  function saveFeedbacks(){ localStorage.setItem('daudFeedbacks', JSON.stringify(allFeedback)); }
  function submitFeedback(){ const text=document.getElementById('feedbackText').value.trim(); if(!selectedProduct||!text){ alert('Please select a product and write feedback'); return;} allFeedback.push({productId:selectedProduct.id,name:selectedProduct.name,text, time:new Date().toLocaleString()}); saveFeedbacks(); document.getElementById('feedbackText').value=''; document.getElementById('selectedFeedbackProduct').style.display='none'; selectedProduct=null; renderFeedbackList(); }
  function renderFeedbackList(){ const el=document.getElementById('feedbackList'); el.innerHTML=''; allFeedback.forEach(fb=>{ const d=document.createElement('div'); d.className='fb-item'; d.innerHTML='<strong>'+fb.name+'</strong><p>'+fb.text+'</p><small>'+fb.time+'</small>'; el.appendChild(d); }); }
  function openAllFeedbacksModal(){ const wrap=document.getElementById('allFeedbacks'); wrap.innerHTML=''; if(!allFeedback.length){ wrap.innerHTML='<p class="muted">No feedback yet</p>'; } else { allFeedback.forEach(fb=>{ const d=document.createElement('div'); d.className='fb-item'; d.innerHTML='<strong>'+fb.name+'</strong><p>'+fb.text+'</p><small>'+fb.time+'</small>'; wrap.appendChild(d); }); } document.getElementById('viewFeedbackModal').classList.add('show'); }
  function updateSiteFeedback(type){ const siteFb=JSON.parse(localStorage.getItem('daudSiteFeedback')||'{"good":0,"bad":0}'); if(type==='good') siteFb.good+=1; else siteFb.bad+=1; localStorage.setItem('daudSiteFeedback', JSON.stringify(siteFb)); document.getElementById('goodCount').textContent=siteFb.good; document.getElementById('badCount').textContent=siteFb.bad; }

  let sliderTimer=null;
  function renderTopThree(){ const wrap=document.getElementById('topThree'); wrap.innerHTML=''; if(!products.length) return; products.slice(0,3).forEach(item=>{ const c=document.createElement('div'); c.className='small-card'; const img=document.createElement('img'); img.src=item.image; img.alt=item.name; c.appendChild(img); c.addEventListener('click',()=>viewProduct(item)); wrap.appendChild(c); }); }
  function initSlider(){ const slides=document.getElementById('slides'); const dots=document.getElementById('slideDots'); slides.innerHTML=''; dots.innerHTML=''; if(sliderTimer){ clearInterval(sliderTimer); sliderTimer=null; } const list=products||[]; if(!list.length) return; const max=Math.min(list.length,6); let idx=0; for(let i=0;i<max;i++){ const item=list[i]; const s=document.createElement('div'); s.className='slide'; const img=document.createElement('img'); img.src=item.image; img.alt=item.name; s.appendChild(img); s.addEventListener('click',()=>viewProduct(item)); slides.appendChild(s); const dot=document.createElement('div'); dot.className='dot'+(i===0?' active':''); dot.addEventListener('click',()=>{ idx=i; update(); reset();}); dots.appendChild(dot);} function update(){ slides.style.transform='translateX(-'+(idx*100)+'% )'; [...dots.children].forEach((d,i)=>d.classList.toggle('active',i===idx)); } function reset(){ if(sliderTimer) clearInterval(sliderTimer); sliderTimer=setInterval(()=>{ idx=(idx+1)%max; update(); },3000);} update(); reset(); }

  function initAdminPanel(){
    document.getElementById('adminOpenBtn').addEventListener('click',()=>{
      if(!currentUser){ alert('Please login from "Sign Up / Login" first.'); return; }
      if(currentUser !== adminConfig.email){ alert('Only the admin email can open the admin panel.'); return; }
      if(!adminLoggedIn){ document.getElementById('adminPanel').classList.add('active'); showToast('Enter admin password to unlock'); return; }
      document.getElementById('adminPanel').classList.add('active');
    });
    document.getElementById('closeAdmin').addEventListener('click',()=>document.getElementById('adminPanel').classList.remove('active'));
    document.getElementById('adminLoginBtn').addEventListener('click',loginAdmin);
    document.getElementById('adminLogoutBtn').addEventListener('click',logoutAdmin);
    document.getElementById('saveAdminConfigBtn').addEventListener('click', ()=>{
      if(!adminLoggedIn){ alert('Unlock admin first.'); return; }
      const newEmail=(document.getElementById('adminEmailSetting').value||'').trim();
      const newPass=(document.getElementById('adminPassSetting').value||'').trim();
      if(newEmail){ adminConfig.email=newEmail; }
      if(newPass){ adminConfig.pass=newPass; }
      saveAdminConfig();
      alert('Admin settings saved.');
      if(currentUser !== adminConfig.email){ logoutAdmin(); alert('Admin email changed. Please login as '+adminConfig.email+' from user login.'); }
      document.getElementById('adminEmailSetting').value=''; document.getElementById('adminPassSetting').value='';
    });

    document.getElementById('logoSetBtn').addEventListener('click',uploadLogo);
    document.getElementById('addProductBtn').addEventListener('click',uploadProduct);
    document.getElementById('clearProductsBtn').addEventListener('click',clearAllProducts);
    document.getElementById('saveSentencesBtn').addEventListener('click',saveSentences);
    document.getElementById('setCurrencyBtn').addEventListener('click',saveCurrency);
    document.getElementById('saveContactsBtn').addEventListener('click',saveContacts);
    document.getElementById('openContactsBtn').addEventListener('click',openContacts);
    document.getElementById('openShare').addEventListener('click',()=>document.getElementById('shareModal').classList.add('show'));
    if(document.getElementById('savePublicLinkBtn')) document.getElementById('savePublicLinkBtn').addEventListener('click',savePublicLink);

    document.querySelectorAll('[data-close]').forEach(btn=>{ btn.addEventListener('click',e=>{ const m=e.target.closest('.modal'); if(m) m.classList.remove('show'); }); });
    document.getElementById('contactWhatsapp').addEventListener('click',()=>{ if(whatsappLink) window.open(whatsappLink,'_blank');});
    document.getElementById('contactMessenger').addEventListener('click',()=>{ if(messengerLink) window.open(messengerLink,'_blank');});
    document.getElementById('shareWhatsapp').addEventListener('click',()=>{ const url=publicLink||window.location.href; window.open('https://wa.me/?text='+encodeURIComponent(url),'_blank');});
    document.getElementById('shareMessenger').addEventListener('click',()=>{ const url=publicLink||window.location.href; window.open('https://m.me/?link='+encodeURIComponent(url),'_blank');});
    document.getElementById('copyLinkBtn').addEventListener('click',()=>{ const url=publicLink||window.location.href; navigator.clipboard.writeText(url).then(()=>alert('Link copied!')).catch(()=>alert('Copy failed.')); });
  }

  function loginAdmin(){ const emailInput=(document.getElementById('adminEmail').value||'').trim(); const pass=(document.getElementById('adminPass').value||'').trim(); if(!currentUser){ alert('Login from user modal first.'); return; } if(currentUser !== adminConfig.email){ alert('Only '+adminConfig.email+' can be admin here. You are logged in as '+currentUser); return; } if(pass !== adminConfig.pass){ alert('Wrong admin password'); return; } adminLoggedIn=true; localStorage.setItem('daudAdminLoggedIn','true'); document.querySelectorAll('.admin-only').forEach(el=>el.style.display='block'); renderProducts(currentPageHome||1); renderProductsFull(currentPageFull||1); document.getElementById('adminPanel').classList.add('active'); alert('Admin unlocked'); document.getElementById('adminEmail').value=''; document.getElementById('adminPass').value=''; }
  function logoutAdmin(){ adminLoggedIn=false; localStorage.removeItem('daudAdminLoggedIn'); document.querySelectorAll('.admin-only').forEach(el=>el.style.display='none'); document.getElementById('adminPanel').classList.remove('active'); renderProducts(currentPageHome||1); renderProductsFull(currentPageFull||1); }

  function uploadLogo(){ const file=document.getElementById('logoInput').files[0]; if(!file) return; const r=new FileReader(); r.onload=e=>{ const saved=JSON.parse(localStorage.getItem('daudSite')||'{}'); saved.logo=e.target.result; localStorage.setItem('daudSite', JSON.stringify(saved)); document.getElementById('siteLogo').src=document.getElementById('heroLogo').src=saved.logo; alert('Logo updated (local). For global logo, set site.logo in products.json'); }; r.readAsDataURL(file); }
  function uploadProduct(){ if(!adminLoggedIn) return alert('Only admin can add products'); const file=document.getElementById('productImageInput').files[0]; if(!file||!document.getElementById('productName').value||!document.getElementById('productPrice').value) return alert('Complete all fields'); const r=new FileReader(); r.onload=e=>{ const id=Date.now(); const item={id,name:document.getElementById('productName').value.trim(),price:document.getElementById('productPrice').value.trim(),desc:document.getElementById('productDesc').value.trim(),image:e.target.result}; products.push(item); localStorage.setItem('daudProducts', JSON.stringify(products)); loadProducts(); document.getElementById('productName').value=document.getElementById('productPrice').value=document.getElementById('productDesc').value=''; document.getElementById('productImageInput').value=''; }; r.readAsDataURL(file); }
  function clearAllProducts(){ if(!adminLoggedIn) return alert('Only admin'); if(!confirm('Are you sure?')) return; products=[]; localStorage.removeItem('daudProducts'); loadProducts(); }

  function editProduct(id){ if(!adminLoggedIn) return alert('Only admin'); const idx=products.findIndex(p=>p.id===id); if(idx===-1) return; const item=products[idx]; const newName=prompt('New product name:', item.name); if(newName!==null && newName.trim()!=='') item.name=newName.trim(); const newPrice=prompt('New price:', item.price); if(newPrice!==null && newPrice.trim()!=='') item.price=newPrice.trim(); const newDesc=prompt('New description:', item.desc); if(newDesc!==null && newDesc.trim()!=='') item.desc=newDesc.trim(); products[idx]=item; localStorage.setItem('daudProducts', JSON.stringify(products)); cart.forEach(c=>{ if(c.id===id){ c.name=item.name; c.price=item.price; }}); saveCart(); loadProducts(); renderCart(); }
  function deleteProduct(id){ if(!adminLoggedIn) return alert('Only admin'); if(!confirm('Delete this product?')) return; products=products.filter(p=>p.id!==id); localStorage.setItem('daudProducts', JSON.stringify(products)); cart=cart.filter(i=>i.id!==id); saveCart(); loadProducts(); renderCart(); }

  function saveSentences(){ if(!adminLoggedIn) return alert('Only admin'); const t=document.getElementById('sentencesInput').value.trim(); if(!t) return; const saved=JSON.parse(localStorage.getItem('daudSite')||'{}'); saved.sentences=t; localStorage.setItem('daudSite', JSON.stringify(saved)); rotatingSentences=t.split(',').map(s=>s.trim()).filter(Boolean); alert('Saved sentences'); }
  function saveCurrency(){ if(!adminLoggedIn) return alert('Only admin'); const sym=document.getElementById('currencyInput').value.trim()||'‡ß≥'; currencySymbol=sym; const saved=JSON.parse(localStorage.getItem('daudSite')||'{}'); saved.currency=sym; localStorage.setItem('daudSite', JSON.stringify(saved)); loadProducts(); alert('Currency symbol saved'); }
  function saveContacts(){ if(!adminLoggedIn) return alert('Only admin'); const code=document.getElementById('whatsappCountry').value; const number=document.getElementById('whatsappNumber').value.trim(); const messenger=document.getElementById('messengerInput').value.trim(); whatsappLink = number ? 'https://wa.me/'+code.replace('+','')+number : ''; messengerLink=messenger; const saved=JSON.parse(localStorage.getItem('daudSite')||'{}'); saved.whatsapp=whatsappLink; saved.messenger=messengerLink; localStorage.setItem('daudSite', JSON.stringify(saved)); alert('Contacts saved'); }
  function openContacts(){ if(!whatsappLink && !messengerLink) return alert('No contacts saved'); if(whatsappLink) window.open(whatsappLink,'_blank'); if(messengerLink) window.open(messengerLink,'_blank'); }
  function savePublicLink(){ if(!adminLoggedIn) return alert('Only admin'); const inp=document.getElementById('publicLinkInput'); if(!inp) return; const link=inp.value.trim(); if(!link) return alert('Enter a valid public link'); publicLink=link; const saved=JSON.parse(localStorage.getItem('daudSite')||'{}'); saved.publicLink=link; localStorage.setItem('daudSite', JSON.stringify(saved)); alert('Public link saved'); }

  function loadUsers(){ users=JSON.parse(localStorage.getItem('daudUsers')||'[]'); } function saveUsers(){ localStorage.setItem('daudUsers', JSON.stringify(users)); }
  function initUserSystem(){ loadUsers(); const stored=localStorage.getItem('daudCurrentUser'); if(stored) currentUser=stored; updateUserAuthButton(); if(!currentUser && !sessionStorage.getItem('daudGuestPromptShown')){ sessionStorage.setItem('daudGuestPromptShown','true'); setTimeout(()=>document.getElementById('userModal').classList.add('show'),800); } document.getElementById('userSignupBtn').addEventListener('click',signupUser); document.getElementById('userLoginBtn').addEventListener('click',loginUser); document.getElementById('userAuthBtn').addEventListener('click',()=>{ if(currentUser) logoutUser(); else document.getElementById('userModal').classList.add('show'); }); }
  function updateUserAuthButton(){ document.getElementById('userAuthBtn').textContent = currentUser ? ('Logout ('+currentUser+')') : 'Sign Up / Login'; }
  function signupUser(){ const emailEl=document.getElementById('userEmail'); const passEl=document.getElementById('userPass'); const email=emailEl.value.trim(); const pass=passEl.value.trim(); if(!email||!pass) return alert('Fill out all fields'); if(users.find(u=>u.email===email)) return alert('User already exists'); users.push({email,pass}); saveUsers(); currentUser=email; localStorage.setItem('daudCurrentUser',currentUser); alert('Account created and logged in'); emailEl.value=''; passEl.value=''; document.getElementById('userModal').classList.remove('show'); updateUserAuthButton(); }
  function loginUser(){ const emailEl=document.getElementById('userEmail'); const passEl=document.getElementById('userPass'); const email=emailEl.value.trim(); const pass=passEl.value.trim(); if(!email||!pass) return alert('Fill out all fields'); const found=users.find(u=>u.email===email&&u.pass===pass); if(!found) return alert('Invalid credentials'); currentUser=email; localStorage.setItem('daudCurrentUser',currentUser); alert('Logged in'); emailEl.value=''; passEl.value=''; document.getElementById('userModal').classList.remove('show'); updateUserAuthButton(); }
  function logoutUser(){ localStorage.removeItem('daudCurrentUser'); currentUser=null; alert('Logged out'); updateUserAuthButton(); if(adminLoggedIn) logoutAdmin(); }

  function checkAdminPersistentLogin(){ const flag=localStorage.getItem('daudAdminLoggedIn')==='true'; if(flag && currentUser===adminConfig.email){ adminLoggedIn=true; document.querySelectorAll('.admin-only').forEach(el=>el.style.display='block'); renderProducts(currentPageHome||1); renderProductsFull(currentPageFull||1); } else { localStorage.removeItem('daudAdminLoggedIn'); adminLoggedIn=false; document.querySelectorAll('.admin-only').forEach(el=>el.style.display='none'); } }

  function autoRotateText(){ let idx=0; setInterval(()=>{ document.getElementById('rotatingText').textContent=rotatingSentences[idx]||'‡¶¶‡¶æ‡¶â‡¶¶ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞'; idx=(idx+1)%rotatingSentences.length; },2600); }
  window.removeFromCart=removeFromCart;
  </script>
</body>
</html>
